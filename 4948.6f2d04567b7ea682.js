"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4948],{4948:(Y,Z,o)=>{o.r(Z),o.d(Z,{MisencuestasPageModule:()=>F});var m=o(6895),b=o(4719),i=o(1558),f=o(2905),l=o(5861),_=o(5670),e=o(6353),x=o(617),M=o(7556),C=o(1098);function E(s,c){1&s&&(e.TgZ(0,"ion-thumbnail",21),e._UZ(1,"img",22),e.qZA())}function A(s,c){1&s&&(e.TgZ(0,"ion-thumbnail",21),e._UZ(1,"img",23),e.qZA())}function T(s,c){if(1&s&&(e.TgZ(0,"ion-item",18),e.YNc(1,E,2,0,"ion-thumbnail",19),e.YNc(2,A,2,0,"ion-thumbnail",19),e.TgZ(3,"ion-label",20)(4,"h3"),e._uU(5),e.qZA(),e.TgZ(6,"p"),e._uU(7),e.ALo(8,"date"),e.qZA()()()),2&s){const t=e.oxw(),n=t.$implicit,a=t.index;e.xp6(1),e.Q6J("ngIf",!(null!=n&&n.Enviado)),e.xp6(1),e.Q6J("ngIf",null==n?null:n.Enviado),e.xp6(3),e.AsE("Indice:",a," Nom: ",null==n?null:n.Nombre,""),e.xp6(2),e.AsE("",null==n?null:n.Descripcion," - Fecha Fin: ",e.xi3(8,6,null==n?null:n.FechaHasta,"dd/MM/yy"),"")}}function J(s,c){if(1&s&&(e.TgZ(0,"div"),e.YNc(1,T,9,9,"ion-item",17),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",(null==t.misencuestasJson?null:t.misencuestasJson.length)>0)}}function P(s,c){1&s&&(e.TgZ(0,"div")(1,"h2",24),e._uU(2,"No hay Encuestas disponibles... "),e.qZA()())}const S=[{path:"",component:(()=>{class s{constructor(t,n,a,r,v,h,d,g){var u=this;this.activatedRoute=t,this.baselocalService=n,this.toastController=a,this.router=r,this.authService=v,this.alertController=h,this.apiVisitArService=d,this.loadingController=g,_.Z.addListener("networkStatusChange",function(){var p=(0,l.Z)(function*(y){u.verificoConectividad(y.connected)});return function(y){return p.apply(this,arguments)}}())}ionViewDidEnter(){var t=this;return(0,l.Z)(function*(){t.activatedRoute.paramMap.subscribe(function(){var n=(0,l.Z)(function*(a){t.id_Campania=Number(a.get("idCampania"))});return function(a){return n.apply(this,arguments)}}()),setTimeout(()=>{console.log("arranco"),t.getMisEncuestasLocal(),_.Z.getStatus().then(function(){var n=(0,l.Z)(function*(a){t.verificoConectividad(a.connected)});return function(a){return n.apply(this,arguments)}}())},500)})()}ngOnInit(){}getMisEncuestasLocal(){this.baselocalService.getArrayEncuestasForIdCam(this.id_Campania).then(t=>{this.misencuestasJson=t},t=>{console.log(t)})}verificoConectividad(t){var n=this;return(0,l.Z)(function*(){t?(console.log("Conectado Internet Get"),setTimeout(()=>{n.postEncuestasSinEnviar()},1500)):(console.log("Sin Internet Get"),n.baselocalService.getArrayEncuestas().then(r=>{},r=>{console.log(r)}),yield(yield n.toastController.create({message:"Sin conectividad",duration:4e3,cssClass:"custom-toast",buttons:[{text:"cerrar",role:"cancel"}]})).present())})()}presentAlert(t,n,a){var r=this;return(0,l.Z)(function*(){yield(yield r.alertController.create({backdropDismiss:!1,cssClass:"alertCustomCss",header:t,subHeader:n,message:a,buttons:["OK"],mode:"ios"})).present()})()}cerrar(){this.authService.logout(),this.router.navigate(["/login"])}nuevaEncuesta(){this.router.navigate(["home",{idCampania:this.id_Campania}])}postEncuestasSinEnviar(){var t=this;return(0,l.Z)(function*(){console.log("Subiendo Encuestas sin enviar");const n=yield t.loadingController.create({message:"Aguarde Subiendo Encuestas sin enviar..."});n.present();var a=t.misencuestasJson?.length,r=0;a>0?yield t.misencuestasJson.forEach(function(){var v=(0,l.Z)(function*(h,d){t.apiVisitArService.postEncuesta(h).subscribe(function(){var g=(0,l.Z)(function*(u){1==u.success?(t.misencuestasJson[d].Enviado=!0,yield t.baselocalService.chageEnviadoIndexEncuestas(d)):console.log(u.success),++r==a&&(console.log("Encuestas Subidad"),n.dismiss(),yield(yield t.toastController.create({message:"Encuestas Enviadas",duration:3e3,cssClass:"custom-toast",buttons:[{text:"cerrar",role:"cancel"}]})).present())});return function(u){return g.apply(this,arguments)}}(),function(){var g=(0,l.Z)(function*(u){++r==a&&(console.log("Finaliza bajada de modelos"),n.dismiss(),yield(yield t.toastController.create({message:"Encuestas Enviadas",duration:3e3,cssClass:"custom-toast",buttons:[{text:"cerrar",role:"cancel"}]})).present()),console.log(u)});return function(u){return g.apply(this,arguments)}}())});return function(h,d){return v.apply(this,arguments)}}()):n.dismiss()})()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(f.gz),e.Y36(x.c),e.Y36(i.yF),e.Y36(f.F0),e.Y36(M.e),e.Y36(i.Br),e.Y36(C.p),e.Y36(i.HT))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-misencuestas"]],decls:22,vars:5,consts:[[3,"translucent"],["color","primary"],["mode","ios"],["slot","end"],["color","secondary",3,"click"],["slot","icon-only","name","log-out"],[3,"fullscreen"],["collapse","condense"],["size","large"],[2,"max-width","500px","width","100%","margin","auto","text-align","center"],["lines","full","detail",""],["color","secondary",2,"height","40px"],[4,"ngFor","ngForOf"],[4,"ngIf"],["horizontal","end","vertical","center","slot","fixed"],["color","danger",3,"click"],["name","add"],["detail","","button","",4,"ngIf"],["detail","","button",""],["slot","start",4,"ngIf"],["text-wrap",""],["slot","start"],["src","assets/imgs/close_icon.svg"],["src","assets/imgs/success_icon.svg"],["text-center",""]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title",2),e._uU(3," VisitAR "),e.qZA(),e.TgZ(4,"ion-buttons",3)(5,"ion-button",4),e.NdJ("click",function(){return n.cerrar()}),e._UZ(6,"ion-icon",5),e.qZA()()()(),e.TgZ(7,"ion-content",6)(8,"ion-header",7)(9,"ion-toolbar")(10,"ion-title",8),e._uU(11,"VisitAR"),e.qZA()()(),e.TgZ(12,"div",9)(13,"ion-list",10)(14,"ion-item-divider",11)(15,"h3"),e._uU(16),e.qZA()(),e.YNc(17,J,2,1,"div",12),e.YNc(18,P,3,0,"div",13),e.qZA()(),e.TgZ(19,"ion-fab",14)(20,"ion-fab-button",15),e.NdJ("click",function(){return n.nuevaEncuesta()}),e._UZ(21,"ion-icon",16),e.qZA()()()),2&t&&(e.Q6J("translucent",!0),e.xp6(7),e.Q6J("fullscreen",!0),e.xp6(9),e.hij("Mis Encuestas-Campa\xf1a Id: ",n.id_Campania,""),e.xp6(1),e.Q6J("ngForOf",n.misencuestasJson),e.xp6(1),e.Q6J("ngIf",(null==n.misencuestasJson?null:n.misencuestasJson.length)<=0))},dependencies:[m.sg,m.O5,i.YG,i.Sm,i.W2,i.IJ,i.W4,i.Gu,i.gu,i.Ie,i.rH,i.Q$,i.q_,i.Bs,i.wd,i.sr,m.uU]}),s})()}];let I=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[f.Bz.forChild(S),f.Bz]}),s})(),F=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[m.ez,b.u5,i.Pc,I]}),s})()}}]);
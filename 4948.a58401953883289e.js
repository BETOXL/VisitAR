"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4948],{4948:(U,M,r)=>{r.r(M),r.d(M,{MisencuestasPageModule:()=>F});var h=r(6895),_=r(4719),i=r(1558),p=r(2905),u=r(5861),Z=r(5670),e=r(6353),y=r(617),x=r(7556),C=r(1098);function E(s,c){1&s&&(e.TgZ(0,"ion-thumbnail",2),e._UZ(1,"img",23),e.qZA())}function A(s,c){1&s&&(e.TgZ(0,"ion-thumbnail",2),e._UZ(1,"img",24),e.qZA())}function T(s,c){if(1&s&&(e.TgZ(0,"ion-item",20),e.YNc(1,E,2,0,"ion-thumbnail",21),e.YNc(2,A,2,0,"ion-thumbnail",21),e.TgZ(3,"ion-label",22)(4,"h3"),e._uU(5),e.qZA(),e.TgZ(6,"p"),e._uU(7),e.ALo(8,"date"),e.qZA()()()),2&s){const t=e.oxw(),n=t.$implicit,a=t.index;e.xp6(1),e.Q6J("ngIf",!(null!=n&&n.Enviado)),e.xp6(1),e.Q6J("ngIf",null==n?null:n.Enviado),e.xp6(3),e.AsE("Indice:",a," Nom: ",null==n?null:n.Nombre,""),e.xp6(2),e.AsE("",null==n?null:n.Descripcion," - Fecha Fin: ",e.xi3(8,6,null==n?null:n.FechaHasta,"dd/MM/yy"),"")}}function J(s,c){if(1&s&&(e.TgZ(0,"div"),e.YNc(1,T,9,9,"ion-item",19),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",(null==t.misencuestasJson?null:t.misencuestasJson.length)>0)}}function P(s,c){1&s&&(e.TgZ(0,"div")(1,"h2",25),e._uU(2,"No hay Encuestas disponibles... "),e.qZA()())}const S=[{path:"",component:(()=>{class s{constructor(t,n,a,o,d,f,g,m){var l=this;this.activatedRoute=t,this.baselocalService=n,this.toastController=a,this.router=o,this.authService=d,this.alertController=f,this.apiVisitArService=g,this.loadingController=m,this.btndisable=!1,Z.Z.addListener("networkStatusChange",function(){var v=(0,u.Z)(function*(b){l.verificoConectividad(b.connected)});return function(b){return v.apply(this,arguments)}}())}ionViewDidEnter(){var t=this;return(0,u.Z)(function*(){t.activatedRoute.paramMap.subscribe(function(){var n=(0,u.Z)(function*(a){t.id_Campania=Number(a.get("idCampania"))});return function(a){return n.apply(this,arguments)}}()),setTimeout(()=>{console.log("arranco"),t.getMisEncuestasLocal(),Z.Z.getStatus().then(function(){var n=(0,u.Z)(function*(a){t.verificoConectividad(a.connected)});return function(a){return n.apply(this,arguments)}}())},500)})()}ngOnInit(){}getMisEncuestasLocal(){this.baselocalService.getArrayEncuestasForIdCam(this.id_Campania).then(t=>{this.misencuestasJson=t},t=>{console.log(t)})}verificoConectividad(t){var n=this;return(0,u.Z)(function*(){t?(console.log("Conectado Internet Get"),setTimeout(()=>{n.postEncuestasSinEnviar()},1500)):(console.log("Sin Internet Get"),n.baselocalService.getArrayEncuestas().then(o=>{},o=>{console.log(o)}),yield(yield n.toastController.create({message:"Sin conectividad",duration:4e3,cssClass:"custom-toast",buttons:[{text:"cerrar",role:"cancel"}]})).present())})()}presentAlert(t,n,a){var o=this;return(0,u.Z)(function*(){yield(yield o.alertController.create({backdropDismiss:!1,cssClass:"alertCustomCss",header:t,subHeader:n,message:a,buttons:["OK"],mode:"ios"})).present()})()}cerrar(){this.authService.logout(),this.router.navigate(["/login"])}nuevaEncuesta(){this.router.navigate(["home",{idCampania:this.id_Campania}])}postEncuestasSinEnviar(){var t=this;return(0,u.Z)(function*(){t.btndisable=!0,console.log("Subiendo Encuestas sin enviar al servidor");const n=yield t.loadingController.create({message:"Aguarde Subiendo Encuestas sin enviar al servidor."});n.present();var a=t.misencuestasJson?.length,o=0;a>0?yield t.misencuestasJson.forEach(function(){var d=(0,u.Z)(function*(f,g){t.apiVisitArService.postEncuesta(f).subscribe(function(){var m=(0,u.Z)(function*(l){1==l.success?(t.misencuestasJson[g].Enviado=!0,yield t.baselocalService.chageEnviadoIndexEncuestas(g)):console.log(l.success),++o==a&&(console.log("Encuestas Subidad"),n.dismiss(),t.btndisable=!1,yield(yield t.toastController.create({message:"Encuestas Enviadas",duration:3e3,cssClass:"custom-toast",buttons:[{text:"cerrar",role:"cancel"}]})).present())});return function(l){return m.apply(this,arguments)}}(),function(){var m=(0,u.Z)(function*(l){++o==a&&(console.log("Finaliza bajada de modelos"),n.dismiss(),t.btndisable=!1,yield(yield t.toastController.create({message:"Encuestas Enviadas",duration:3e3,cssClass:"custom-toast",buttons:[{text:"cerrar",role:"cancel"}]})).present()),console.log(l)});return function(l){return m.apply(this,arguments)}}())});return function(f,g){return d.apply(this,arguments)}}()):(t.btndisable=!1,n.dismiss(),console.log("No hay encuestas guardadas o todas ya fueron subidas al servidor"))})()}getDistanciaMetros(t,n,a,o){var d=function(Y){return Y*Math.PI/180},g=d(a-t),m=d(o-n),l=Math.sin(g/2)*Math.sin(g/2)+Math.cos(d(t))*Math.cos(d(a))*Math.sin(m/2)*Math.sin(m/2);return 2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6378.137*1e3}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(p.gz),e.Y36(y.c),e.Y36(i.yF),e.Y36(p.F0),e.Y36(x.e),e.Y36(i.Br),e.Y36(C.p),e.Y36(i.HT))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-misencuestas"]],decls:24,vars:6,consts:[[3,"translucent"],["color","primary"],["slot","start"],["defaultHref","campanias"],["mode","ios"],["slot","end"],["color","secondary",3,"click"],["slot","icon-only","name","log-out"],[3,"fullscreen"],["collapse","condense"],["size","large"],[2,"max-width","500px","width","100%","margin","auto","text-align","center"],["lines","full","detail",""],["color","secondary",2,"height","40px"],[4,"ngFor","ngForOf"],[4,"ngIf"],["horizontal","end","vertical","center","slot","fixed"],["color","danger",3,"disabled","click"],["name","add"],["detail","","button","",4,"ngIf"],["detail","","button",""],["slot","start",4,"ngIf"],["text-wrap",""],["src","assets/imgs/close_icon.svg"],["src","assets/imgs/success_icon.svg"],["text-center",""]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),e._UZ(3,"ion-back-button",3),e.qZA(),e.TgZ(4,"ion-title",4),e._uU(5," VisitAR "),e.qZA(),e.TgZ(6,"ion-buttons",5)(7,"ion-button",6),e.NdJ("click",function(){return n.cerrar()}),e._UZ(8,"ion-icon",7),e.qZA()()()(),e.TgZ(9,"ion-content",8)(10,"ion-header",9)(11,"ion-toolbar")(12,"ion-title",10),e._uU(13,"VisitAR"),e.qZA()()(),e.TgZ(14,"div",11)(15,"ion-list",12)(16,"ion-item-divider",13)(17,"h3"),e._uU(18),e.qZA()(),e.YNc(19,J,2,1,"div",14),e.YNc(20,P,3,0,"div",15),e.qZA()(),e.TgZ(21,"ion-fab",16)(22,"ion-fab-button",17),e.NdJ("click",function(){return n.nuevaEncuesta()}),e._UZ(23,"ion-icon",18),e.qZA()()()),2&t&&(e.Q6J("translucent",!0),e.xp6(9),e.Q6J("fullscreen",!0),e.xp6(9),e.hij("Mis Encuestas-Campa\xf1a Id: ",n.id_Campania,""),e.xp6(1),e.Q6J("ngForOf",n.misencuestasJson),e.xp6(1),e.Q6J("ngIf",(null==n.misencuestasJson?null:n.misencuestasJson.length)<=0),e.xp6(2),e.Q6J("disabled",n.btndisable))},dependencies:[h.sg,h.O5,i.oU,i.YG,i.Sm,i.W2,i.IJ,i.W4,i.Gu,i.gu,i.Ie,i.rH,i.Q$,i.q_,i.Bs,i.wd,i.sr,i.cs,h.uU]}),s})()}];let I=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[p.Bz.forChild(S),p.Bz]}),s})(),F=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[h.ez,_.u5,i.Pc,I]}),s})()}}]);
"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4948],{4948:(U,M,r)=>{r.r(M),r.d(M,{MisencuestasPageModule:()=>Y});var h=r(6895),y=r(4719),i=r(1558),p=r(2905),u=r(5861),Z=r(5670),e=r(6353),_=r(617),x=r(7556),C=r(1098);function E(n,c){1&n&&(e.TgZ(0,"ion-thumbnail",2),e._UZ(1,"img",23),e.qZA())}function S(n,c){1&n&&(e.TgZ(0,"ion-thumbnail",2),e._UZ(1,"img",24),e.qZA())}function A(n,c){if(1&n&&(e.TgZ(0,"ion-item",20),e.YNc(1,E,2,0,"ion-thumbnail",21),e.YNc(2,S,2,0,"ion-thumbnail",21),e.TgZ(3,"ion-label",22)(4,"h3"),e._uU(5),e.qZA(),e.TgZ(6,"p"),e._uU(7),e.ALo(8,"date"),e.qZA()()()),2&n){const t=e.oxw(),s=t.$implicit,a=t.index;e.xp6(1),e.Q6J("ngIf",!(null!=s&&s.Enviado)),e.xp6(1),e.Q6J("ngIf",null==s?null:s.Enviado),e.xp6(3),e.AsE("Indice:",a," Nom: ",null==s?null:s.Nombre,""),e.xp6(2),e.AsE("",null==s?null:s.Descripcion," - Fecha Fin: ",e.xi3(8,6,null==s?null:s.FechaHasta,"dd/MM/yy"),"")}}function T(n,c){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,A,9,9,"ion-item",19),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",(null==t.misencuestasJson?null:t.misencuestasJson.length)>0)}}function J(n,c){1&n&&(e.TgZ(0,"div")(1,"h2",25),e._uU(2,"No hay Encuestas disponibles... "),e.qZA()())}const P=[{path:"",component:(()=>{class n{constructor(t,s,a,o,d,f,m,g){var l=this;this.activatedRoute=t,this.baselocalService=s,this.toastController=a,this.router=o,this.authService=d,this.alertController=f,this.apiVisitArService=m,this.loadingController=g,this.btndisable=!1,Z.Z.addListener("networkStatusChange",function(){var v=(0,u.Z)(function*(b){l.verificoConectividad(b.connected)});return function(b){return v.apply(this,arguments)}}())}ionViewDidEnter(){var t=this;return(0,u.Z)(function*(){t.activatedRoute.paramMap.subscribe(function(){var s=(0,u.Z)(function*(a){t.id_Campania=Number(a.get("idCampania"))});return function(a){return s.apply(this,arguments)}}()),setTimeout(()=>{console.log("arranco"),t.getMisEncuestasLocal(),Z.Z.getStatus().then(function(){var s=(0,u.Z)(function*(a){t.verificoConectividad(a.connected)});return function(a){return s.apply(this,arguments)}}())},500)})()}ngOnInit(){}getMisEncuestasLocal(){this.baselocalService.getArrayEncuestasForIdCam(this.id_Campania).then(t=>{this.misencuestasJson=t},t=>{console.log(t)})}verificoConectividad(t){var s=this;return(0,u.Z)(function*(){t?(console.log("Conectado Internet Get"),setTimeout(()=>{s.postEncuestasSinEnviar()},1500)):(console.log("Sin Internet Get"),s.baselocalService.getArrayEncuestas().then(o=>{},o=>{console.log(o)}),yield(yield s.toastController.create({message:"Sin conectividad",duration:4e3,cssClass:"custom-toast",buttons:[{text:"cerrar",role:"cancel"}]})).present())})()}presentAlert(t,s,a){var o=this;return(0,u.Z)(function*(){yield(yield o.alertController.create({backdropDismiss:!1,cssClass:"alertCustomCss",header:t,subHeader:s,message:a,buttons:["OK"],mode:"ios"})).present()})()}cerrar(){this.authService.logout(),this.router.navigate(["/login"])}nuevaEncuesta(){this.router.navigate(["home",{idCampania:this.id_Campania}])}postEncuestasSinEnviar(){var t=this;return(0,u.Z)(function*(){t.btndisable=!0,console.log("Intentando subir Encuestas sin enviar al servidor");const s=yield t.loadingController.create({message:"Intentando subir Encuestas sin enviar al servidor."});s.present();var a=t.misencuestasJson?.length,o=0;a>0?yield t.misencuestasJson.forEach(function(){var d=(0,u.Z)(function*(f,m){0==f.Enviado?t.apiVisitArService.postEncuesta(f).subscribe(function(){var g=(0,u.Z)(function*(l){1==l.success?(t.misencuestasJson[m].Enviado=!0,yield t.baselocalService.chageEnviadoIndexEncuestas(m)):console.log(l.success),++o==a&&(console.log("Encuestas Subidad"),s.dismiss(),t.btndisable=!1,yield(yield t.toastController.create({message:"Encuestas Subidas al Servidor",duration:3e3,cssClass:"custom-toast",buttons:[{text:"cerrar",role:"cancel"}]})).present())});return function(l){return g.apply(this,arguments)}}(),function(){var g=(0,u.Z)(function*(l){++o==a&&(console.log("Encuestas Subidas al Servidor"),s.dismiss(),t.btndisable=!1,yield(yield t.toastController.create({message:"Encuestas Subidas al Servidor",duration:3e3,cssClass:"custom-toast",buttons:[{text:"cerrar",role:"cancel"}]})).present()),console.log(l)});return function(l){return g.apply(this,arguments)}}()):++o==a&&(console.log("Encuestas Subidas al Servidor"),s.dismiss(),t.btndisable=!1,yield(yield t.toastController.create({message:"Encuestas Subidas al Servidor",duration:3e3,cssClass:"custom-toast",buttons:[{text:"cerrar",role:"cancel"}]})).present())});return function(f,m){return d.apply(this,arguments)}}()):(t.btndisable=!1,s.dismiss(),console.log("No hay encuestas guardadas o todas ya fueron subidas al servidor"))})()}getDistanciaMetros(t,s,a,o){var d=function(F){return F*Math.PI/180},m=d(a-t),g=d(o-s),l=Math.sin(m/2)*Math.sin(m/2)+Math.cos(d(t))*Math.cos(d(a))*Math.sin(g/2)*Math.sin(g/2);return 2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6378.137*1e3}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.gz),e.Y36(_.c),e.Y36(i.yF),e.Y36(p.F0),e.Y36(x.e),e.Y36(i.Br),e.Y36(C.p),e.Y36(i.HT))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-misencuestas"]],decls:24,vars:6,consts:[[3,"translucent"],["color","primary"],["slot","start"],["defaultHref","campanias"],["mode","ios"],["slot","end"],["color","secondary",3,"click"],["slot","icon-only","name","log-out"],[3,"fullscreen"],["collapse","condense"],["size","large"],[2,"max-width","500px","width","100%","margin","auto","text-align","center"],["lines","full","detail",""],["color","secondary",2,"height","40px"],[4,"ngFor","ngForOf"],[4,"ngIf"],["horizontal","end","vertical","center","slot","fixed"],["color","danger",3,"disabled","click"],["name","add"],["detail","","button","",4,"ngIf"],["detail","","button",""],["slot","start",4,"ngIf"],["text-wrap",""],["src","assets/imgs/close_icon.svg"],["src","assets/imgs/success_icon.svg"],["text-center",""]],template:function(t,s){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),e._UZ(3,"ion-back-button",3),e.qZA(),e.TgZ(4,"ion-title",4),e._uU(5," VisitAR "),e.qZA(),e.TgZ(6,"ion-buttons",5)(7,"ion-button",6),e.NdJ("click",function(){return s.cerrar()}),e._UZ(8,"ion-icon",7),e.qZA()()()(),e.TgZ(9,"ion-content",8)(10,"ion-header",9)(11,"ion-toolbar")(12,"ion-title",10),e._uU(13,"VisitAR"),e.qZA()()(),e.TgZ(14,"div",11)(15,"ion-list",12)(16,"ion-item-divider",13)(17,"h3"),e._uU(18),e.qZA()(),e.YNc(19,T,2,1,"div",14),e.YNc(20,J,3,0,"div",15),e.qZA()(),e.TgZ(21,"ion-fab",16)(22,"ion-fab-button",17),e.NdJ("click",function(){return s.nuevaEncuesta()}),e._UZ(23,"ion-icon",18),e.qZA()()()),2&t&&(e.Q6J("translucent",!0),e.xp6(9),e.Q6J("fullscreen",!0),e.xp6(9),e.hij("Mis Encuestas-Campa\xf1a Id: ",s.id_Campania,""),e.xp6(1),e.Q6J("ngForOf",s.misencuestasJson),e.xp6(1),e.Q6J("ngIf",(null==s.misencuestasJson?null:s.misencuestasJson.length)<=0),e.xp6(2),e.Q6J("disabled",s.btndisable))},dependencies:[h.sg,h.O5,i.oU,i.YG,i.Sm,i.W2,i.IJ,i.W4,i.Gu,i.gu,i.Ie,i.rH,i.Q$,i.q_,i.Bs,i.wd,i.sr,i.cs,h.uU]}),n})()}];let I=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[p.Bz.forChild(P),p.Bz]}),n})(),Y=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[h.ez,y.u5,i.Pc,I]}),n})()}}]);
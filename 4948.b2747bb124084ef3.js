"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4948],{4948:(N,_,r)=>{r.r(_),r.d(_,{MisencuestasPageModule:()=>Y});var C=r(6895),p=r(4719),i=r(1558),v=r(2905),u=r(5861),M=r(5670),e=r(6353),Z=r(617),y=r(7556),x=r(1098);function T(n,l){1&n&&(e.TgZ(0,"ion-thumbnail",2),e._UZ(1,"img",24),e.qZA())}function E(n,l){1&n&&(e.TgZ(0,"ion-thumbnail",2),e._UZ(1,"img",25),e.qZA())}function S(n,l){if(1&n&&(e.TgZ(0,"ion-item",21),e.YNc(1,T,2,0,"ion-thumbnail",22),e.YNc(2,E,2,0,"ion-thumbnail",22),e.TgZ(3,"ion-label",23)(4,"h3"),e._uU(5),e.qZA(),e.TgZ(6,"p"),e._uU(7),e.qZA()()()),2&n){const t=e.oxw(),s=t.$implicit,a=t.index;e.xp6(1),e.Q6J("ngIf",!(null!=s&&s.Enviado)),e.xp6(1),e.Q6J("ngIf",null==s?null:s.Enviado),e.xp6(3),e.lnq("N",a," Id:",null==s?null:s.IdCampania_data," - Identi: ",null==s?null:s.Identificador,""),e.xp6(2),e.AsE("",null==s?null:s.Descripcion," - Fecha: ",null==s?null:s.Fecha,"")}}function I(n,l){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,S,8,7,"ion-item",20),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",(null==t.filterCoints?null:t.filterCoints.length)>0)}}function J(n,l){1&n&&(e.TgZ(0,"div")(1,"h2",26),e._uU(2,"No hay Encuestas Buscadas... "),e.qZA()())}const A=[{path:"",component:(()=>{class n{constructor(t,s,a,o,d,h,g,f){var c=this;this.activatedRoute=t,this.baselocalService=s,this.toastController=a,this.router=o,this.authService=d,this.alertController=h,this.apiVisitArService=g,this.loadingController=f,this.btndisable=!1,this.searchText="",M.Z.addListener("networkStatusChange",function(){var m=(0,u.Z)(function*(b){c.verificoConectividad(b.connected)});return function(b){return m.apply(this,arguments)}}())}ionViewDidEnter(){var t=this;return(0,u.Z)(function*(){t.activatedRoute.paramMap.subscribe(function(){var s=(0,u.Z)(function*(a){t.id_Campania=Number(a.get("idCampania"))});return function(a){return s.apply(this,arguments)}}()),setTimeout(()=>{console.log("arranco"),t.getMisEncuestasLocal(),M.Z.getStatus().then(function(){var s=(0,u.Z)(function*(a){t.verificoConectividad(a.connected)});return function(a){return s.apply(this,arguments)}}())},500)})()}ngOnInit(){}getMisEncuestasLocal(){this.baselocalService.getArrayEncuestasForIdCam(this.id_Campania).then(t=>{this.misencuestasJson=t,this.filterCoints=this.misencuestasJson},t=>{console.log(t)})}verificoConectividad(t){var s=this;return(0,u.Z)(function*(){t?(console.log("Conectado Internet Get"),setTimeout(()=>{s.postEncuestasSinEnviar()},1500)):(console.log("Sin Internet Get"),s.baselocalService.getArrayEncuestas().then(o=>{},o=>{console.log(o)}),yield(yield s.toastController.create({message:"Sin conectividad",duration:4e3,cssClass:"custom-toast",buttons:[{text:"cerrar",role:"cancel"}]})).present())})()}presentAlert(t,s,a){var o=this;return(0,u.Z)(function*(){yield(yield o.alertController.create({backdropDismiss:!1,cssClass:"alertCustomCss",header:t,subHeader:s,message:a,buttons:["OK"],mode:"ios"})).present()})()}cerrar(){this.authService.logout(),this.router.navigate(["/login"])}nuevaEncuesta(){this.router.navigate(["home",{idCampania:this.id_Campania}])}postEncuestasSinEnviar(){var t=this;return(0,u.Z)(function*(){t.btndisable=!0,console.log("Intentando subir Encuestas sin enviar al servidor");const s=yield t.loadingController.create({message:"Intentando subir Encuestas sin enviar al servidor."});s.present();var a=t.misencuestasJson?.length,o=0;a>0?yield t.misencuestasJson.forEach(function(){var d=(0,u.Z)(function*(h,g){0==h.Enviado?t.apiVisitArService.postEncuesta(h).subscribe(function(){var f=(0,u.Z)(function*(c){1==c.success?(t.misencuestasJson[g].Enviado=!0,t.misencuestasJson[g].IdCampania_data=c.idCampania_data,yield t.baselocalService.chageEnviadoIndexEncuestas(g)):console.log(c.success),++o==a&&(console.log("Encuestas Subidad"),s.dismiss(),t.btndisable=!1,yield(yield t.toastController.create({message:"Encuestas Subidas al Servidor",duration:3e3,cssClass:"custom-toast",buttons:[{text:"cerrar",role:"cancel"}]})).present(),t.filterCoints=t.misencuestasJson)});return function(c){return f.apply(this,arguments)}}(),function(){var f=(0,u.Z)(function*(c){++o==a&&(console.log("Encuestas Subidas al Servidor"),s.dismiss(),t.btndisable=!1,yield(yield t.toastController.create({message:"Encuestas Subidas al Servidor",duration:3e3,cssClass:"custom-toast",buttons:[{text:"cerrar",role:"cancel"}]})).present()),console.log(c)});return function(c){return f.apply(this,arguments)}}()):++o==a&&(console.log("Encuestas Subidas al Servidor"),s.dismiss(),t.btndisable=!1,yield(yield t.toastController.create({message:"Encuestas Subidas al Servidor",duration:3e3,cssClass:"custom-toast",buttons:[{text:"cerrar",role:"cancel"}]})).present())});return function(h,g){return d.apply(this,arguments)}}()):(t.btndisable=!1,s.dismiss(),console.log("No hay encuestas guardadas o todas ya fueron subidas al servidor"))})()}getDistanciaMetros(t,s,a,o){var d=function(F){return F*Math.PI/180},g=d(a-t),f=d(o-s),c=Math.sin(g/2)*Math.sin(g/2)+Math.cos(d(t))*Math.cos(d(a))*Math.sin(f/2)*Math.sin(f/2);return 2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))*6378.137*1e3}searchCoin(){this.filterCoints=this.misencuestasJson.filter(t=>t.Identificador.toLowerCase().includes(this.searchText.toLowerCase())||t.IdCampania_data==Number(this.searchText.toLowerCase()))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v.gz),e.Y36(Z.c),e.Y36(i.yF),e.Y36(v.F0),e.Y36(y.e),e.Y36(i.Br),e.Y36(x.p),e.Y36(i.HT))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-misencuestas"]],decls:25,vars:7,consts:[[3,"translucent"],["color","primary"],["slot","start"],["defaultHref","campanias"],["mode","ios"],["slot","end"],["color","secondary",3,"click"],["slot","icon-only","name","log-out"],["mode","md",1,"ion-padding","gradient",3,"fullscreen"],["collapse","condense"],["size","large"],[1,"container"],["lines","full","detail",""],["color","secondary",2,"height","40px"],["type","text","placeholder","Buscar por Id, Identi",1,"text-center","border-0","text-light",2,"width","95%","text-align","center",3,"ngModel","ngModelChange","keyup"],[4,"ngFor","ngForOf"],[4,"ngIf"],["horizontal","end","vertical","center","slot","fixed"],["color","danger",3,"disabled","click"],["name","add"],["button","",4,"ngIf"],["button",""],["slot","start",4,"ngIf"],["text-wrap",""],["src","assets/imgs/close_icon.svg"],["src","assets/imgs/success_icon.svg"],["text-center",""]],template:function(t,s){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),e._UZ(3,"ion-back-button",3),e.qZA(),e.TgZ(4,"ion-title",4),e._uU(5," VisitAR "),e.qZA(),e.TgZ(6,"ion-buttons",5)(7,"ion-button",6),e.NdJ("click",function(){return s.cerrar()}),e._UZ(8,"ion-icon",7),e.qZA()()()(),e.TgZ(9,"ion-content",8)(10,"ion-header",9)(11,"ion-toolbar")(12,"ion-title",10),e._uU(13,"VisitAR"),e.qZA()()(),e.TgZ(14,"div",11)(15,"ion-list",12)(16,"ion-item-divider",13)(17,"h3"),e._uU(18),e.qZA()(),e.TgZ(19,"input",14),e.NdJ("ngModelChange",function(o){return s.searchText=o})("keyup",function(){return s.searchCoin()}),e.qZA(),e.YNc(20,I,2,1,"div",15),e.YNc(21,J,3,0,"div",16),e.qZA()(),e.TgZ(22,"ion-fab",17)(23,"ion-fab-button",18),e.NdJ("click",function(){return s.nuevaEncuesta()}),e._UZ(24,"ion-icon",19),e.qZA()()()),2&t&&(e.Q6J("translucent",!0),e.xp6(9),e.Q6J("fullscreen",!0),e.xp6(9),e.hij("Mis Encuestas-Campa\xf1a Id: ",s.id_Campania,""),e.xp6(1),e.Q6J("ngModel",s.searchText),e.xp6(1),e.Q6J("ngForOf",s.filterCoints),e.xp6(1),e.Q6J("ngIf",(null==s.filterCoints?null:s.filterCoints.length)<=0),e.xp6(2),e.Q6J("disabled",s.btndisable))},dependencies:[C.sg,C.O5,p.Fj,p.JJ,p.On,i.oU,i.YG,i.Sm,i.W2,i.IJ,i.W4,i.Gu,i.gu,i.Ie,i.rH,i.Q$,i.q_,i.Bs,i.wd,i.sr,i.cs]}),n})()}];let P=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[v.Bz.forChild(A),v.Bz]}),n})(),Y=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[C.ez,p.u5,i.Pc,P]}),n})()}}]);